# ГЛАВНЫЙ ФАЙЛ МИГРАЦИЙ БАЗЫ ДАННЫХ
# Проект: Stock History Service (Итоговый проект JavaRush)
# Автор: Irina Pavlenko
# ====================================================
# Liquibase выполняет миграции ПО ПОРЯДКУ сверху вниз.
# Уже выполненные миграции НЕЛЬЗЯ изменять или перемещать.
# Для изменений существующих таблиц создавайте НОВЫЕ миграции.
# ====================================================
databaseChangeLog:
  # ========================
  # МИГРАЦИЯ 001: Таблица пользователей
  # ========================
  - include:
      file: db/changelog/changes/001-create-users-table.yaml
        # Базовые таблица для регистрации и авторизации.
        # Создается ПЕРВОЙ, потому что все другие данные привязаны к пользователю.

  # ========================
  # МИГРАЦИЯ 002: Основная таблица проекта - исторические данные акций
  # ========================
  - include:
      file: db/changelog/changes/002-create-stock-history-table.yaml
      # СОДЕРЖАНИЕ: Данные из Polygon.io API (open, close, high, low, volume)
      # СВЯЗЬ: Каждая запись принадлежит одному пользователю (user_id → users.id)
      # ТРЕБОВАНИЕ ТЗ: Уникальность по комбинации (ticker, date, user_id)
      #                Констрейнт: uk_ticker_date_user
  # ========================
  # МИГРАЦИЯ 003: Справочник тикеров
  # ========================
  - include:
      file: db/changelog/changes/003-create-tickers-table.yaml
      # СОДЕРЖАНИЕ: Справочник доступных для запроса акций
      # НАЗНАЧЕНИЕ: Для валидации тикеров при сохранении данных пользователем
      # ТРЕБОВАНИЕ ТЗ: "ticker должен содержаться в справочной таблице тикеров"
      # СВЯЗЬ: Используется как справочник, не имеет внешних ключей
      # ДАННЫЕ: Содержит предустановленные тикеры (AAPL, GOOGL, MSFT)